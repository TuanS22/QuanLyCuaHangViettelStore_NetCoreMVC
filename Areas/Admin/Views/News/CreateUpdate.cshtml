@using TTTN_ViettelStore.Models;

@{
    Layout = "~/Areas/Admin/Views/Shared/Index.cshtml";
}


<!-- Để load ckeditor vào trang thì phải có dòng dưới đây-->
<script src="https://cdn.ckeditor.com/ckeditor5/40.0.0/classic/ckeditor.js"></script>


<div class="bg-gray-500 h-screen w-screen sm:px-8 md:px-16 sm:py-8 h-auto">
    <main class="container mx-auto max-w-screen-lg h-full">
        <!-- file upload modal -->
        <article aria-label="File Upload Modal" class="relative h-full flex flex-col bg-white shadow-xl rounded-md" ondrop="dropHandler(event);" ondragover="dragOverHandler(event);" ondragleave="dragLeaveHandler(event);" ondragenter="dragEnterHandler(event);">

            <section class="h-full overflow-auto p-8 w-full h-full flex flex-col">
                

                <div class="col-md-12">
                    <div class="panel panel-primary">
                        <div class="panel-body">
                            @* autocomplete="off" sẽ bỏ các thông tin catche của trình duyệt lưu vào ô textbox *@
                            @*Muốn upload được file thì trong thẻ form phải có thuộc tính sau: enctype="multipart/form-data"*@
                            <form method="post" action="@ViewBag.action" enctype="multipart/form-data" autocomplete="off">
                                <!-- rows -->
                                <div class="row" style="margin-top:5px;">
                                    <div class="col-md-2" style="font-size: 1.5rem; color: black;">Photo</div>
                                    <div class="col-md-10">
                                        <input type="file" name="Photo" id="file" class="inputfile" data-multiple-caption="{count} files" multiple />
                                        <label for="file">
                                            <span>
                                                <i class="fa-solid fa-cloud-arrow-up"></i>
                                                Chọn file
                                            </span>
                                        </label>
                                    </div>
                                </div>
                                <!-- end rows -->
                                <!-- rows -->
                                <div class="row" style="margin-top:30px;">
                                    <div class="flex">
                                        <div class="form-floating">
                                            <input type="text" class="form-control" name="Name" placeholder="Tin tức" required value="@Model?.Name">
                                            <label style="padding: 19px 12px; font-size: 14px; color: black; font-weight: bold;">
                                                Tin tức
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <!-- end rows -->
                                
                                <style>
                                    .ck-editor__editable {
                                        min-height: 300px;
                                        max-height: 300px;
                                        overflow: scroll;
                                    }

                                    .inputfile {
                                        width: 0.1px;
                                        height: 0.1px;
                                        opacity: 0;
                                        overflow: hidden;
                                        position: absolute;
                                        z-index: -1;
                                    }

                                    label {
                                        padding: 5px;
                                        border-radius: 5px;
                                    }

                                    .inputfile + label {
                                        width: 150px;
                                        font-size: 1rem;
                                        font-weight: 700;
                                        text-align: center;
                                        color: black;
                                        background-color: white;
                                        display: inline-block;
                                        cursor: pointer;
                                        border: 2px solid gray;
                                    }

                                        .inputfile:focus + label,
                                        .inputfile + label:hover {
                                            border: 2px groove red;
                                            color: gray;
                                        }

                                        .inputfile + label span i {
                                            padding-right: 5px;
                                            color: red;
                                        }

                                    .form-floating {
                                        width: 100%;
                                    }

                                        .form-floating > .form-control {
                                            height: 60px;
                                            min-height: 60px;
                                            font-size: 18px;
                                        }
                                </style>

                                <!-- rows -->
                                <div class="row" style="margin-top:30px;">
                                    <div class="flex">
                                        <div class="form-floating">
                                            <input type="date" class="form-control" name="Timestamp" placeholder="Timestamp" required value="@Model?.Timestamp?.ToString()">
                                            <label style="padding: 19px 12px; font-size: 14px; color: black; font-weight: bold;">
                                                Timestamp
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <!-- end rows -->
                                <!-- rows -->
                                <div class="row" style="margin-top:15px;">
                                    <div class="col-md-2" style="font-size: 1.5rem; color: black;">Hot</div>
                                    <div class="col-md-10">
                                        <input id="hot" type="checkbox" @if (Model != null && Model.Hot == 1)
                                        {
                                            <text>checked</text>
                                        } name="Hot"> <label for="hot">Hot</label>
                                    </div>
                                </div>
                                <!-- end rows -->
                                <!-- rows -->
                                <div class="row" style="margin-top:15px;">
                                    <div class="col-md-2" style="font-size: 1.5rem; color: black;">Content</div>
                                    <div class="col-md-10">
                                        <textarea placeholder="Nhập nội dung" name="Content" id="Content">@if (Model != null)
                                            {
                                                <text>@Model.Content</text>
                                            }</textarea>
                                        <script style="font-size: 1.5rem;">
                                            ClassicEditor
                                                .create(document.querySelector('#Content'))
                                                .catch(error => {
                                                    console.error(error);
                                                });
                                        </script>
                                    </div>
                                </div>
                                <!-- end rows -->
                                <!-- sticky footer -->
                                <footer class="flex justify-end px-8 pb-8 pt-4">
                                    <div class="">
                                        <input type="submit" value="Lưu" class="rounded-sm px-4 py-1 bg-blue-700 hover:bg-blue-500 text-white focus:shadow-outline focus:outline-none">
                                    </div>
                                    <div class="text-black px-2 ml-4 border-1 border-blue-500 rounded-sm hover:bg-gray-300">
                                        <a href="/Admin/News/Read">Quay lại</a>
                                    </div>
                                </footer>
                            </form>
                        </div>
                    </div>
                </div>
            </section>
        </article>
    </main>
</div>

<script>
    var inputs = document.querySelectorAll('.inputfile');
    Array.prototype.forEach.call(inputs, function (input) {
        var label = input.nextElementSibling,
            labelVal = label.innerHTML;

        input.addEventListener('change', function (e) {
            var fileName = '';
            var img;
            if (this.files && this.files.length > 1) {
                fileName = (this.getAttribute('data-multiple-caption') || '').replace('{count}', this.files.length);
            }
            else
                fileName = e.target.value.split('\\').pop();

            if (fileName) {
                // Tạo một thẻ <i> mới chứa biểu tượng trước tên ảnh
                var icon = document.createElement('i');
                icon.classList.add('fa-regular', 'fa-image');

                // Chèn thẻ <i> vào label trước nội dung tên file
                label.querySelector('span').innerHTML = '';
                label.querySelector('span').appendChild(icon);
                label.querySelector('span').innerHTML += fileName;
            }
            else
                label.innerHTML = labelVal;
        });
    });
</script>

